# 2023-12-13

### Java Stream은 너무 어렵다.

stream 적당한 map이나 forEach등은 쓸수 있겠는데, 기타 키워드들이 너무 어렵다. 해당 프로젝트 조금 여유가 생기면 자바의 정석 다시 봐야할 것 같다.

for문을 안쓰고, 일괄적으로 함수식으로 적용할 수 있다는 점은 매우 좋다고 생각하는데, 익숙해지기 까지 시간이 오래걸린다.

### MainFeed 기능 완성

법안의 stage별로 피드를 띄우는 기능을 완성했다. Pageable을 사용하는 것에 익숙해지고, 이것이 limit, offset등을 편하게 해주는 좋은 기능임을 깨달았다.

해당 프로젝트 덕분에 기본기가 충실히 쌓여가는 것 같다. 싸피 때 이런 기분이었어야 했는데, 그 때는 너무 급하기만 하고 아쉬운 점이 많았다. 

### 스왑 영역

프리티어로 배포하는데, 메모리가 1GB다. 그렇기 때문에, 자꾸 자바 빌드를 하면 터진다. 자바 빌드를 위해 gradle을 설치하려는 순간 ex) gradlew clean build 그 명령어를 입력하는 순간 어김없이 먹통이다.

나는 메모리 1GB정도면 그래도 빌드자체는 할 수 있을 줄 알았는데, 그것조차 안될 줄은 몰랐다. 시간이 없는 상황속에서 Jenkins 구축하는 것도 힘들고, Jenkins자체가 먹는 메모리도 있다 보니 젠킨스는 꿈도 못꾼다.

그런 상황속에서, 저번에 프리티어 배포할 때, 스왑영역을 통해 배포하던 팀원이 생각나서, 스왑영역을 통해 배포를 시도하여 성공한 것이 기뻤다.

당연히 하드디스크의 용량을 램으로 사용하는 것이기 때문에 속도가 느려서 팀원들이 학교에서 받아온 프로젝트용 서버에서 구현했다.

[스왑 파일을 사용하여 Amazon EC2 인스턴스의 스왑 공간으로 메모리 할당 | AWS re:Post](https://repost.aws/ko/knowledge-center/ec2-memory-swap-file)

- AWS는 친절하게도 스왑영역을 어떻게 늘릴 수 있는지 설명해준다.

- 나중에 써먹어봐야지

### Swagger

스웨거를 도입했지만, 기존 Spring Boot 2.X버전 때 쓰던 Swagger는 사용을 못하고, Spring open-ai에서 사용되는 swagger를 사용하는데, 기존에 알던 어노테이션이 어떤 변경사항이 있는지 공식문서에 가면 친절하게 설명을 해준다. 역시 블로그보다는 공식문서가 최고다...

하지만, 새로운 Swagger 사용법을 익히는것보다 그냥 기존 노션에 정리된 API명세서 형식대로 계속 찍어내는게 좋다고 판단해서 Swagger는 나중에 쓰기로 헀다.

Swagger에 대해 구글링하다가  바로 존재하는 우아한형제들의 Spring Rest Docs 적용기

[Spring Rest Docs 적용 | 우아한형제들 기술블로그](https://techblog.woowahan.com/2597/)

나는 항상 Swagger를 사용할 때면 코드가 더러워진다는 말에 굉장히 공감했는데, 해당 포스팅에서도 제품코드에 어노테이션으로 인한 코드 가독성이 떨어지는 것에 거부감이 많이 와닿은 것 같았다. 그래서, 다음 프로젝트에서 적용해보고 싶다.

### JPA findById와 getById의 차이

- [[JPA] findById() , getById() 에 대한 생각 — RR](https://k3068.tistory.com/103)

- 둘다 Id를 통해 객체를 가져온다.

- 근데, findById는 즉시로딩이고 getById는 지연로딩이다.

- 이러한 차이로 인해서 findById는 Id와 일치하는 것이 있는지 확인하는 select 쿼리를 날린 후에, 값을 가져온다. getById의 경우 일치하는지 확인하지 않고 바로 가져온다.

- 해당 글에서 말하는 바는 여기서 제공하는 Id값에 대응하는 객체가 무조건적으로 존재하면 getById를 사용해도 괜찮다 라는 뜻이다.

### JPA DB 순환참조

JPA에서 순환참조가 발생하여 jpa제공 메서드를 사용을 못함 확실히 외래키 남발하면 안되는데.. 화가 조금 날것같다. 데이터 넣겠다고 너무 외래키를 막쓴 데이터 팀이 참 슬프다.

지금까지 JPA로 만들기 쉽지 않은 쿼리를 만들기 위해 JPQL로 처리해왔는데, JPARepository가 제공하는 메서드를 사용할 수가 없다. Dto를 직접 생성하는 게 아니라 엔티티에 선언한 형태로 가져오려고 헀는데, 순환참조로 인해 가져올 수 없다는 오류 발생하였다.

하지만, 이 또한 배울 수 있는 게 많았다. 해당 프로젝트에서 짜증이 막 난 것도 많았지만, 배우는 것도 많았기 때문에, 이런 과정이 나를 더 크게 만들 수 있을 것 같다. 
